% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/postgres_connect.R
\name{check_tables_needs_update_batched}
\alias{check_tables_needs_update_batched}
\title{Batch-Update-Check für mehrere Tabellen (Optimiert)}
\usage{
check_tables_needs_update_batched(
  tables,
  local_con,
  ssh_session,
  postgres_keys,
  verbose = FALSE
)
}
\arguments{
\item{tables}{Character vector mit Tabellennamen im Format "schema.table"}

\item{local_con}{DBI connection zur lokalen Datenbank}

\item{ssh_session}{SSH session object (aus ssh::ssh_connect)}

\item{postgres_keys}{Character vector mit \link{password, user, database, host, port}}

\item{verbose}{Logical, ob detaillierte Fortschrittsmeldungen ausgegeben werden}
}
\value{
Named list mit Tabellennamen als Namen und TRUE/FALSE als Werte
}
\description{
Prüft für mehrere Tabellen gleichzeitig, ob sie aktualisiert werden müssen.
Diese Funktion reduziert die Anzahl der SSH-Queries drastisch, indem sie
alle Prüfungen in 2-3 kombinierten Queries durchführt statt 5*N einzelne Queries.
}
\details{
Die Funktion führt folgende Optimierungen durch:
\itemize{
\item Batch-Check: Alle Tabellen werden in einem einzigen SSH-Query geprüft
\item Reduziert 5*N SSH-Queries auf 2-3 Queries total (N = Anzahl Tabellen)
\item Verwendet UNION ALL für effizienten Batch-Query
}

Logik für Update-Entscheidung (identisch zur Einzelprüfung):
\enumerate{
\item Tabelle existiert nicht lokal → TRUE (muss geladen werden)
\item Keine updated_at Spalte lokal oder auf Server → FALSE (nicht aktualisieren)
\item Server MAX(updated_at) > lokales MAX(updated_at) → TRUE
\item Server row count ≠ lokaler row count → TRUE
\item Sonst → FALSE
}
}
\examples{
\dontrun{
ssh_session <- ssh::ssh_connect("user@server")
local_con <- DBI::dbConnect(RSQLite::SQLite(), "local.db")
keys <- c("password", "user", "dbname", "localhost", "5432")

# Prüfe mehrere Tabellen auf einmal
results <- check_tables_needs_update_batched(
  tables = c("public.users", "public.orders", "public.products"),
  local_con = local_con,
  ssh_session = ssh_session,
  postgres_keys = keys,
  verbose = TRUE
)
# results: list(public.users = TRUE, public.orders = FALSE, public.products = TRUE)
}

}
\keyword{internal}
