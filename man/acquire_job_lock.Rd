% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_export_queue_handling.R
\name{acquire_job_lock}
\alias{acquire_job_lock}
\title{Acquire Advisory Lock for Job}
\usage{
acquire_job_lock(con, job_name)
}
\arguments{
\item{con}{Database connection object (DBI connection)}

\item{job_name}{Character string identifying the job}
}
\value{
Logical. TRUE if lock was successfully acquired, FALSE if lock is
already held by another session
}
\description{
Attempts to acquire a PostgreSQL advisory lock for the given job name.
Advisory locks are session-level locks stored in PostgreSQL memory that
prevent race conditions when multiple processes try to start the same job.
The lock is automatically released when the database connection closes.
}
\details{
This function uses PostgreSQL's pg_try_advisory_lock() which:
\itemize{
\item Returns immediately (non-blocking)
\item Uses a numeric lock ID derived from CRC32 hash of job_name
\item Is automatically released on connection close or manual release
\item Is session-scoped (not transaction-scoped)
}
}
\examples{
\dontrun{
con <- postgres_connect(needed_tables = c("processed.data_job_events"))

if (acquire_job_lock(con, "daily_export")) {
  message("Lock acquired, running job...")
  # ... run job ...
  release_job_lock(con, "daily_export")
} else {
  message("Lock already held by another process")
}
}
}
